/******************************************************************************
 * @file        str_ww_ref_model_depthwise_conv_4.c
 * @brief       Autogenerated AOT DEPTHWISE_CONV_2D kernel
 * @details     This file was generated by HeliosAOT v0.2.2 on 2025-08-05.
 *   This kernel represents node #4 in the corresponding graph.
 *
 * @date        2025-08-05
 *
 * @copyright
 *   © 2025 Ambiq. All rights reserved.
 *
 *   This generated C module is licensed for use **only** on Ambiq hardware
 *   incorporating Ambiq’s sub-threshold power optimized technology.
 *   Any other use is strictly prohibited.
 *
 *   See “LICENSE.txt” at the root of this distribution for full terms.
 *
 * @note        Do not edit this file—any changes will be overwritten.
 ******************************************************************************/
#include <stdalign.h>
#include "ns_ambiqsuite_harness.h"
#include "arm_nnfunctions.h"
#include "arm_nnsupportfunctions.h"
#include "str_ww_ref_model_depthwise_conv_4.h"

#if defined(ARM_MATH_MVEI)
#define SCRATCH_BUFFER_SIZE 4960
#define WEIGHT_SUM_BUFFER_SIZE 512
#elif defined(ARM_MATH_DSP)
#define SCRATCH_BUFFER_SIZE 0
#define WEIGHT_SUM_BUFFER_SIZE 0
#else
#define SCRATCH_BUFFER_SIZE 0
#define WEIGHT_SUM_BUFFER_SIZE 0
#endif

// Input dimensions: input shape is [1, H_IN, W_IN, C_IN]
static const cmsis_nn_dims dw_4_input_dims = { .n = 1, .h = 24, .w = 1, .c = 128 };

// Filter dimensions: weights shape is [1, H_FILT, W_FILT, C_OUT].
static const cmsis_nn_dims dw_4_filter_dims = { .n = 1, .h = 10, .w = 1, .c = 128 };

// Bias dimensions: bias shape is [1, 1, 1, C_OUT].
static const cmsis_nn_dims dw_4_bias_dims = { .n = 1, .h = 1, .w = 1, .c = 128 };

// Output dimensions: output shape is [1, H_OUT, W_OUT, C_OUT].
static const cmsis_nn_dims dw_4_output_dims = { .n = 1, .h = 15, .w = 1, .c = 128 };

// Quantization parameters (per-channel quantization)
static const int32_t dw_4_multiplier[128] = {
    1690904772, 1584898081, 1670096975, 1489186836, 1759366562, 1156116973, 1823059878, 1301993898, 1351763383, 1123826672, 1580084833, 1273249116, 1585850287, 1300988326, 1762380892, 1305603476, 1243537139, 1348333286, 1097147547, 2084449127,
    1759113378, 1591581276, 1878034032, 1443780751, 1423199215, 1536052448, 2077406778, 1748008835, 1191983630, 1829154794, 1639177701, 1129712034, 1338065335, 2042255756, 1466271662, 1328022500, 1356410516, 1374293532, 1304724305, 1886949668,
    2060152138, 1966055460, 1900136767, 2027716819, 1279462986, 1916850100, 1693428966, 1366009326, 1191145605, 2132842047, 1197392126, 1075648556, 2071741472, 1409569809, 2059297692, 1172275537, 1665366499, 1614781233, 1669989477, 1175393356,
    1554607087, 1169309228, 1360819263, 1363336201, 1711516285, 2005569023, 1869724432, 1710930680, 1321314197, 1756765802, 1472264809, 1696693425, 1958698829, 1168046081, 1238233754, 2020381573, 1523723135, 1921063137, 1656807916, 2037342170,
    1249547852, 1441890470, 1736670011, 2002101789, 1183412445, 1375891297, 2070535128, 1102491697, 1216489409, 1780236222, 1472874186, 1896824384, 1347951411, 1932605118, 1693630023, 1394498921, 1793509052, 1901545886, 1636179982, 1692037032,
    1233816224, 1204421394, 2054749561, 1660049080, 1764656103, 1093617208, 1650266206, 2039084857, 1107824295, 1644598226, 1291641553, 1611058716, 1966430461, 1384650078, 1081926486, 1415681719, 1598338650, 1702031274, 2097809788, 1600745704,
    1537105850, 1729468039, 2146931326, 1998959339, 1589928425, 2045642414, 1110401569, 1396934520
};
static const int32_t dw_4_shift[128] = {
    -9, -9, -8, -8, -8, -8, -9, -8, -8, -8, -9, -8, -9, -8, -9, -8, -8, -8, -8, -9,
    -9, -9, -9, -9, -8, -8, -9, -9, -8, -9, -9, -8, -8, -9, -9, -8, -9, -8, -8, -9,
    -9, -9, -9, -9, -9, -9, -9, -8, -9, -9, -9, -8, -8, -8, -9, -8, -8, -8, -9, -9,
    -8, -8, -8, -8, -9, -9, -9, -9, -8, -9, -9, -9, -9, -8, -8, -9, -9, -9, -9, -9,
    -8, -8, -9, -9, -8, -8, -9, -8, -8, -9, -9, -9, -9, -9, -9, -8, -9, -9, -9, -9,
    -9, -8, -9, -9, -9, -8, -9, -9, -8, -9, -8, -9, -9, -8, -8, -9, -8, -9, -9, -9,
    -9, -9, -9, -9, -9, -9, -8, -9
};

// Offsets and activation parameters.
static const int32_t dw_4_input_zero_point = -128;
static const int32_t dw_4_output_zero_point = 11;


// Weight and bias data.
alignas(16) static NS_PUT_IN_TCM int8_t dw_4_weights[] = {
    102, 110, 31, -72, 127, 49, 23, 127, -127, 127, 112, -6, 75, 127, 54, -95, 78, 127, 127, 16,
    53, 127, -127, -123, 127, 127, -116, -32, -115, -127, -88, -127, -91, -127, 12, -127, 0, -127, -127, 127,
    -127, -118, -79, -67, -127, 91, -127, 127, 94, 76, -46, 123, 12, -127, -127, -127, -38, -59, 127, -61,
    58, 19, 74, -56, 65, -37, 127, 60, -68, 18, -56, -122, -12, 79, 127, -93, -26, 68, 127, -14,
    -43, 1, 127, -127, 119, 44, -54, 127, 127, -66, 21, 62, -60, -127, -9, -127, -80, 64, 105, -127,
    -46, 55, 80, -66, -126, 94, -81, -127, 127, 85, 127, 104, -103, 67, 19, 110, -127, 73, 33, -29,
    39, 127, -51, 61, -45, 73, 98, -117, 127, 59, -20, -37, 28, 58, -13, 25, -39, 105, 109, 24,
    0, 20, 44, -17, 33, 56, 104, 30, -38, 72, -77, -88, 35, 96, -60, -121, -92, -89, -97, -34,
    -40, -108, 56, 3, 113, -46, -6, 99, -90, -62, -68, 4, -94, 48, -56, 42, 127, 65, -82, 64,
    -11, -49, -56, -23, -2, -7, 107, 119, 31, 7, 50, 12, 7, -33, 32, 80, 10, -22, 46, -32,
    -36, 30, 72, -35, -91, 75, 7, 0, 23, -6, 6, -77, 42, 6, -37, 72, 123, -42, -58, 42,
    -43, -93, -36, -37, -33, 9, 108, -64, 9, -8, 47, -109, -71, 44, -112, -75, 97, -28, 99, 106,
    -31, 27, 32, 94, -51, 90, 6, -101, -61, -16, -26, 17, -87, 18, 19, -70, 122, 69, 4, -17,
    31, 13, -3, 29, -35, 90, 115, 28, 9, -57, 60, -31, 23, 35, 86, 18, -127, 41, -73, -127,
    17, 37, -40, -127, -58, -47, -46, 25, 12, -112, 56, -24, 46, -8, -23, 49, -74, -70, -22, -19,
    -115, 98, -79, 17, 71, 117, -78, 40, -14, -11, -69, -54, 21, -15, 117, 85, 57, 16, 50, -4,
    -33, -29, -12, 66, -31, 36, 113, 2, 65, 14, 41, -20, -71, 84, -54, -27, 7, 1, -8, -62,
    25, -52, -91, 76, 105, -80, -65, -86, -75, -41, -97, -49, -98, 6, 127, 36, -6, -10, 93, -127,
    -96, 19, -127, -60, 46, -127, 81, 44, -17, 23, 2, 127, -26, 76, -11, -127, -59, 1, 15, 122,
    -127, -12, 21, -111, 120, 69, 0, -4, 30, 49, -11, 12, -14, 85, 102, 46, 59, -54, 12, -15,
    34, 11, 9, 11, -83, 65, -81, -109, 8, 3, -62, -30, 12, -84, -59, 24, -5, -65, 5, -2,
    108, -13, -32, 63, -7, -104, 30, -2, -97, 58, -94, 5, -55, 22, -96, -41, -6, 32, -44, -10,
    9, 13, 4, 123, 54, 1, 55, -18, -79, -79, -35, 43, -41, -21, 64, 122, 80, 34, 49, 65,
    11, 115, -124, -36, -39, -30, -16, -15, 23, -59, -80, 2, 96, -127, 16, -119, -125, -78, -127, -41,
    -96, 60, 102, 75, 88, 52, 127, -82, -105, 12, -81, -92, 11, -109, 37, 75, -56, 27, 0, 93,
    15, 127, -2, -61, 5, -33, 32, 51, -97, -73, -24, -127, 103, 73, -5, 2, 18, 1, -55, 0,
    -8, 66, 34, 59, -42, -26, -57, -12, -19, -30, 52, -51, -67, 111, -55, -47, -22, -5, 7, 78,
    -20, -77, -69, 27, 28, -63, -5, -11, 94, -16, -54, 26, -52, -81, 44, -65, -81, 72, -64, 26,
    78, 0, -127, -58, -3, 40, 31, -19, 9, 14, -28, 43, 52, -21, -1, -35, -112, -101, -49, -83,
    -46, -103, 127, 127, 107, 31, 41, 121, -5, 127, -85, 34, -1, 7, -86, 0, 42, -39, -32, -14,
    62, -86, 51, -127, -102, -40, -31, -78, -127, 127, 100, 40, 118, 27, 55, -87, -16, -2, -61, -71,
    25, -123, 44, 72, -20, -20, -54, 24, 45, 62, -75, -84, 5, -23, 87, 60, -106, -125, 43, -61,
    46, 76, -20, -20, 0, 3, -107, -7, 16, -1, 68, 101, -55, -18, -82, -26, -54, -29, 50, -127,
    -33, 77, 25, -91, -46, -1, 44, 2, 21, -113, -127, 9, 39, 5, -122, 20, 127, -19, -31, -17,
    -5, -89, 10, -31, -110, 58, -89, 31, 83, 7, -99, -26, 15, 46, 53, -24, -4, 19, 24, 118,
    38, 71, -21, -18, -86, -59, -79, -109, -23, -127, 64, 26, 127, -7, 66, 86, 62, 9, -61, 55,
    -46, 64, -25, -56, 33, -9, 45, -52, 38, -91, 115, -46, -86, 2, 44, -64, -76, 73, 46, 79,
    114, -2, 59, -57, -19, -20, 10, -39, 46, -74, 33, -7, 43, -24, -127, -7, 28, 6, -103, -79,
    -33, -109, 30, 39, -57, -127, 58, -69, -46, -42, -7, 64, -26, 2, -103, 1, -16, -13, 86, 127,
    -70, 13, -87, -35, -99, -11, 108, -118, 79, 66, 108, -71, -41, 14, 18, 61, 23, -120, -67, -11,
    -7, -2, 6, 49, 79, -26, -60, 21, 0, -51, 14, -60, -71, 51, -10, 36, 79, -62, -47, -80,
    11, 45, 46, -22, -30, -2, -13, 127, 33, 37, -48, 30, -127, -21, -126, -127, 28, -72, 27, -16,
    70, 3, 92, 81, 103, 30, 28, 64, -68, 56, -68, -28, 31, -10, -5, -31, 49, 79, 127, 39,
    -127, 32, 73, -52, 10, 35, 89, 104, 73, 4, 55, -125, 67, -90, 39, -12, 46, -48, 50, -63,
    64, -55, -121, -36, 14, -38, -97, -38, -77, -91, -27, 31, -46, -67, 23, -54, -10, -90, -2, 19,
    -18, -34, -127, -13, 0, 7, 127, 5, -127, 37, -127, -41, -127, -9, 41, -96, 101, 23, 77, -13,
    -15, -1, -22, 19, 32, -46, -39, -2, -48, -22, -72, 73, 66, -10, 3, -26, 11, -4, 71, -101,
    -18, 69, 2, 11, 67, -65, -99, -23, 10, 47, 79, 29, -7, -7, -48, -50, -48, 50, -38, 28,
    -101, 27, -116, -59, 60, -60, -4, -86, 56, -21, 53, 24, 126, -34, 0, 84, -43, 68, -93, -52,
    13, -10, 84, -53, 31, 80, 102, 18, -41, 49, 83, -78, -59, 29, 61, 53, 96, -53, 28, -45,
    92, -127, 3, -20, -26, 29, 53, -126, 127, -47, -45, -103, -13, -47, -111, -21, -127, -58, -89, 40,
    -48, -1, -41, -1, -54, -127, -70, 54, 1, -23, -108, -44, 42, -4, 76, -25, -46, -2, -43, -72,
    -95, -32, 56, -90, 28, -46, -13, -84, -18, -17, -94, 48, 79, -13, -3, -83, -60, 9, -127, 28,
    104, -45, -36, -17, 34, 55, 45, -44, -60, 94, -16, -37, 15, -65, -101, -75, 44, 0, 21, 32,
    -17, 55, 27, -119, -60, 66, -57, 101, -78, 76, -86, -26, 80, -82, 78, -106, 55, -77, 15, -53,
    126, 7, 71, 125, -15, 71, -88, -87, 72, 27, 73, -73, 44, 89, 22, -11, -76, 37, -49, -85,
    -93, 45, 35, 13, 127, -102, 11, -37, 94, -86, -86, -31, 3, 92, 58, -50, 90, -75, 36, -25,
    -53, -55, -127, -83, -99, -58, -127, 40, -25, -1, -84, -52, -55, -120, -127, 127, -13, -127, -38, -123,
    73, 49, 72, -34, 62, -20, 4, -127, -72, -88, 34, -83, 40, -18, -17, -88, -69, -29, -127, 84,
    127, -38, -13, -58, -127, 76, -86, 48, 121, -65, -14, 4, 69, 127, 127, -127, -31, 127, -46, -46,
    -32, -127, -38, -127, 127, 46, -20, -24, -127, 127, -21, -112, -127, 127, -127, 127, -52, 127, -110, 29,
    127, -113, 58, -41, 33, -127, 14, -127, 127, -49, 123, 127, -127, 127, -78, -17, 127, 127, 127, -88,
    57, 83, 31, -65, -77, 33, -118, -33, -41, 42, -35, 31, 101, -127, -57, 20, 127, -97, -112, -22,
    -21, 39, 21, -127, 46, -127, 75, -125, -66, -118, -21, -98, -111, -15, -50, 127, -90, -26, -127, -71
};

alignas(16) static NS_PUT_IN_TCM int32_t dw_4_bias[] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0
};

alignas(16) static NS_PUT_IN_TCM int8_t dw_4_scratch_buffer[SCRATCH_BUFFER_SIZE];
alignas(16) static NS_PUT_IN_TCM int8_t dw_4_weight_sum_buffer[WEIGHT_SUM_BUFFER_SIZE];

static cmsis_nn_context dw_4_ctx = {
    .buf = dw_4_scratch_buffer,
    .size = sizeof(dw_4_scratch_buffer),
};

static cmsis_nn_context dw_4_weight_sum_ctx = {
    .buf = dw_4_weight_sum_buffer,
    .size = sizeof(dw_4_weight_sum_buffer),
};


const cmsis_nn_per_channel_quant_params dw_4_quant_params = {
    .multiplier = (int32_t*)dw_4_multiplier,
    .shift = (int32_t*)dw_4_shift,
};

const cmsis_nn_dw_conv_params dw_4_dw_conv_params = {
    .input_offset = -dw_4_input_zero_point,
    .output_offset = dw_4_output_zero_point,
    .ch_mult = 1,
    .stride.w = 1,
    .stride.h = 1,
    .padding.w = 0,
    .padding.h = 0,
    .dilation.w = 1,
    .dilation.h = 1,
    .activation.min = -128,
    .activation.max = 127,
};

int32_t
str_ww_ref_model_depthwise_conv_4_init(void) {
    return arm_depthwise_convolve_weight_sum(
        (int32_t *)dw_4_weight_sum_buffer,
        NULL, // No scratch buffer required
        dw_4_weights,
        &dw_4_dw_conv_params,
        &dw_4_input_dims,
        &dw_4_filter_dims,
        &dw_4_output_dims,
        dw_4_dw_conv_params.input_offset,
        dw_4_bias
    );
}


int32_t
str_ww_ref_model_depthwise_conv_4_run(
    const int8_t* __restrict input,
    int8_t* __restrict output
) {

    return arm_depthwise_conv_wrapper_s8(
        &dw_4_ctx,
        &dw_4_weight_sum_ctx,
        &dw_4_dw_conv_params,
        &dw_4_quant_params,
        &dw_4_input_dims,
        input,
        &dw_4_filter_dims,
        dw_4_weights,
        &dw_4_bias_dims,
        dw_4_bias,
        &dw_4_output_dims,
        output
    );

}