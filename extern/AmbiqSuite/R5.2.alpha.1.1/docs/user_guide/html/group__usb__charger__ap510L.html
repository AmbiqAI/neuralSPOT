<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AmbiqSuite User Guide: USB Charger Functionality</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="paramAlign.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="am_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">AmbiqSuite User Guide<span id="projectnumber">&#160;SDK 5.2.alpha.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">USB Charger Functionality<div class="ingroups"><a class="el" href="group__hal.html">mcu</a> &raquo; <a class="el" href="group__apollo330P__hal.html">apollo330P</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Purpose: This module implements USB Battery Charging Specification 1.2 compliant charger detection for Apollo5 devices. It provides comprehensive functionality for identifying different charger types (SDP, CDP, DCP), managing data pin connections, and optimizing charging behavior based on the detected charger type.</p>
<h1><a class="anchor" id="hal_usbcharger_features"></a>
Key Features</h1>
<ol type="1">
<li><b>BC1.2</b> <b>Compliance:</b> Full implementation of USB BC1.2 detection protocol</li>
<li><b>Charger</b> <b>Detection:</b> Identifies SDP, CDP, and DCP charger types</li>
<li><b>Pin</b> <b>Management:</b> Controls and monitors D+/D- pin states</li>
<li><b>Voltage</b> <b>Control:</b> Configurable voltage comparators for pin sensing</li>
<li><b>Power</b> <b>Optimization:</b> Automatic charging current adjustment</li>
</ol>
<h1><a class="anchor" id="hal_usbcharger_functionality"></a>
Functionality</h1>
<ul>
<li>Primary and Secondary charger detection</li>
<li>Data pin contact detection (DCD)</li>
<li>Voltage comparator configuration</li>
<li>Charger-specific current draw control</li>
<li>USB PHY and hardware reset management</li>
</ul>
<h1><a class="anchor" id="hal_usbcharger_usage"></a>
Usage</h1>
<ol type="1">
<li>Initialize with hardware reset/unreset functions</li>
<li>Perform data pin contact detection</li>
<li>Execute primary detection for SDP</li>
<li>Run secondary detection for CDP/DCP</li>
<li>Configure charging based on detected type</li>
</ol>
<h1><a class="anchor" id="hal_usbcharger_configuration"></a>
Configuration</h1>
<ul>
<li>Data pin connection settings</li>
<li>Voltage comparator reference levels</li>
<li>Charger-specific current limits</li>
<li>PHY reset override controls</li>
<li>Hardware reset management</li>
</ul>
<h1><a class="anchor" id="hal_usbcharger_types"></a>
Charger Types</h1>
<ul>
<li>SDP (Standard Downstream Port): PC/laptop ports</li>
<li>CDP (Charging Downstream Port): High-current capable hosts</li>
<li>DCP (Dedicated Charging Port): Wall chargers </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">USB charger physical connection status.</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>USB charger data pin connection status.</p>
<p>The Dm and Dp pins of the USB device have two connection status: 1- Connected: When the Dm and Dp are connected (for SDP(Standard Downstream
   Port) and CDP(Charger Downstream Port) chargers only) 2- Unknown: When the Dm and Dp are not connected to the USB cable or the charger type is DCP(Dedicated Charger Port). </p>
</td></tr>
<tr class="memitem:ga158d28807d989eb9ca762717de412c35" id="r_ga158d28807d989eb9ca762717de412c35"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga158d28807d989eb9ca762717de412c35">am_hal_usb_charger_data_pin_status_e</a> { <br />
&#160;&#160;<a class="el" href="#gga158d28807d989eb9ca762717de412c35a2566735bc1d3d47c56273ca256759118">AM_HAL_USB_CHARGER_DATA_PIN_CONNECTED</a>
, <br />
&#160;&#160;<a class="el" href="#gga158d28807d989eb9ca762717de412c35a8ee21db77d57caacd3e685340e6f7477">AM_HAL_USB_CHARGER_DATA_PIN_CONNECTION_UNKNOWN</a>
<br />
 }</td></tr>
<tr class="separator:ga158d28807d989eb9ca762717de412c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">USB charger type</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>Macro definitions for the USB charger type.</p>
<p>These macros are used to indicate what kind of charger is connected to the USB port: 1-SDP: Standard Downstream Port like a PC/laptop. 2-CDP: Charging Downstream Port is a downstream port on a device that complies with the USB 2.0 definition of a host or a hub. 3-DCP: A Dedicated Charging Port (DCP) is a downstream port on a device that outputs power through a USB connector, but is not capable of enumerating a downstream device. </p>
</td></tr>
<tr class="memitem:ga444d51d0bee34cd7a54b1c44a4c614f9" id="r_ga444d51d0bee34cd7a54b1c44a4c614f9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga444d51d0bee34cd7a54b1c44a4c614f9">am_hal_usb_charger_type_e</a> { <br />
&#160;&#160;<a class="el" href="#gga444d51d0bee34cd7a54b1c44a4c614f9a388f72ec92765679180f8d9fd281ec7a">AM_HAL_USB_CHARGER_SDP</a>
, <br />
&#160;&#160;<a class="el" href="#gga444d51d0bee34cd7a54b1c44a4c614f9a6c649a65ebe1974311ae84b0cee5350b">AM_HAL_USB_CHARGER_CDP</a>
, <br />
&#160;&#160;<a class="el" href="#gga444d51d0bee34cd7a54b1c44a4c614f9a2ef3ad52bde4780b4d51013bacb46aad">AM_HAL_USB_CHARGER_DCP</a>
, <br />
&#160;&#160;<a class="el" href="#gga444d51d0bee34cd7a54b1c44a4c614f9ab8f015de27a9dd433d30a0f3dbad50f4">AM_HAL_USB_CHARGER_NO_CHARGER</a>
<br />
 }</td></tr>
<tr class="separator:ga444d51d0bee34cd7a54b1c44a4c614f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Vendor-specific comparator ref voltage</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>Vendor-specific comparator ref voltage</p>
<p>These macros are used to program the voltage comparator for DP/DM USB pins: The reference voltage for the comparator for each pin can be 1.25V, 1.65V, 2.35V, and 3.10V. The output of the comparators is connected to BCDETSTATUS.DMCOMPOUT and BCDETSTATUS.DPCOMPOUT. </p>
</td></tr>
<tr class="memitem:ga6fef264a63160af980725f7a2cdff9dc" id="r_ga6fef264a63160af980725f7a2cdff9dc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6fef264a63160af980725f7a2cdff9dc">am_hal_usb_charger_comparator_reference_voltage_e</a> { <br />
&#160;&#160;<a class="el" href="#gga6fef264a63160af980725f7a2cdff9dcaec972c3740bb804bf13c3da04e4ab5de">AM_HAL_USB_CHARGER_SET_REF_VOL_TO_1P65</a> = 0x0
, <br />
&#160;&#160;<a class="el" href="#gga6fef264a63160af980725f7a2cdff9dca110dd694887c0e4371efc240366b4bd0">AM_HAL_USB_CHARGER_SET_REF_VOL_TO_3P10V</a> = 0x1
, <br />
&#160;&#160;<a class="el" href="#gga6fef264a63160af980725f7a2cdff9dca207190b892be35f163ee8ba599026c7f">AM_HAL_USB_CHARGER_SET_REF_VOL_TO_2P35</a> = 0x2
, <br />
&#160;&#160;<a class="el" href="#gga6fef264a63160af980725f7a2cdff9dca00dfd79d258e9c1d80babc2361b3b9c0">AM_HAL_USB_CHARGER_SET_REF_VOL_TO_1P25V</a> = 0x3
<br />
 }</td></tr>
<tr class="separator:ga6fef264a63160af980725f7a2cdff9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga6fef264a63160af980725f7a2cdff9dc" name="ga6fef264a63160af980725f7a2cdff9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6fef264a63160af980725f7a2cdff9dc">&#9670;&#160;</a></span>am_hal_usb_charger_comparator_reference_voltage_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga6fef264a63160af980725f7a2cdff9dc">am_hal_usb_charger_comparator_reference_voltage_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga6fef264a63160af980725f7a2cdff9dcaec972c3740bb804bf13c3da04e4ab5de" name="gga6fef264a63160af980725f7a2cdff9dcaec972c3740bb804bf13c3da04e4ab5de"></a>AM_HAL_USB_CHARGER_SET_REF_VOL_TO_1P65&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga6fef264a63160af980725f7a2cdff9dca110dd694887c0e4371efc240366b4bd0" name="gga6fef264a63160af980725f7a2cdff9dca110dd694887c0e4371efc240366b4bd0"></a>AM_HAL_USB_CHARGER_SET_REF_VOL_TO_3P10V&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga6fef264a63160af980725f7a2cdff9dca207190b892be35f163ee8ba599026c7f" name="gga6fef264a63160af980725f7a2cdff9dca207190b892be35f163ee8ba599026c7f"></a>AM_HAL_USB_CHARGER_SET_REF_VOL_TO_2P35&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga6fef264a63160af980725f7a2cdff9dca00dfd79d258e9c1d80babc2361b3b9c0" name="gga6fef264a63160af980725f7a2cdff9dca00dfd79d258e9c1d80babc2361b3b9c0"></a>AM_HAL_USB_CHARGER_SET_REF_VOL_TO_1P25V&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<a id="ga158d28807d989eb9ca762717de412c35" name="ga158d28807d989eb9ca762717de412c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga158d28807d989eb9ca762717de412c35">&#9670;&#160;</a></span>am_hal_usb_charger_data_pin_status_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga158d28807d989eb9ca762717de412c35">am_hal_usb_charger_data_pin_status_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga158d28807d989eb9ca762717de412c35a2566735bc1d3d47c56273ca256759118" name="gga158d28807d989eb9ca762717de412c35a2566735bc1d3d47c56273ca256759118"></a>AM_HAL_USB_CHARGER_DATA_PIN_CONNECTED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga158d28807d989eb9ca762717de412c35a8ee21db77d57caacd3e685340e6f7477" name="gga158d28807d989eb9ca762717de412c35a8ee21db77d57caacd3e685340e6f7477"></a>AM_HAL_USB_CHARGER_DATA_PIN_CONNECTION_UNKNOWN&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<a id="ga444d51d0bee34cd7a54b1c44a4c614f9" name="ga444d51d0bee34cd7a54b1c44a4c614f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga444d51d0bee34cd7a54b1c44a4c614f9">&#9670;&#160;</a></span>am_hal_usb_charger_type_e</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga444d51d0bee34cd7a54b1c44a4c614f9">am_hal_usb_charger_type_e</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga444d51d0bee34cd7a54b1c44a4c614f9a388f72ec92765679180f8d9fd281ec7a" name="gga444d51d0bee34cd7a54b1c44a4c614f9a388f72ec92765679180f8d9fd281ec7a"></a>AM_HAL_USB_CHARGER_SDP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga444d51d0bee34cd7a54b1c44a4c614f9a6c649a65ebe1974311ae84b0cee5350b" name="gga444d51d0bee34cd7a54b1c44a4c614f9a6c649a65ebe1974311ae84b0cee5350b"></a>AM_HAL_USB_CHARGER_CDP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga444d51d0bee34cd7a54b1c44a4c614f9a2ef3ad52bde4780b4d51013bacb46aad" name="gga444d51d0bee34cd7a54b1c44a4c614f9a2ef3ad52bde4780b4d51013bacb46aad"></a>AM_HAL_USB_CHARGER_DCP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga444d51d0bee34cd7a54b1c44a4c614f9ab8f015de27a9dd433d30a0f3dbad50f4" name="gga444d51d0bee34cd7a54b1c44a4c614f9ab8f015de27a9dd433d30a0f3dbad50f4"></a>AM_HAL_USB_CHARGER_NO_CHARGER&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
</div><!-- contents -->
<hr size="1">
    <body>
        <div id="footer" align="right">        
            <small>
                Generated on Thu Oct 30 2025 19:27:28 for the AmbiqSuite User Guide by&nbsp;
                <a href="http://www.ambiqmicro.com">
                <img class="footer" src="./ambiq_logo.png" alt="Ambiq"/></a>&nbsp&nbsp Copyright &copy; 2025&nbsp&nbsp<br />
                This documentation is licensed and distributed under the <a rel="license" href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause License</a>.&nbsp&nbsp<br/>
            </small>
        </div>
    </body>
</html>
