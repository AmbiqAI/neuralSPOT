/******************************************************************************
 * @file        str_ww_ref_model_depthwise_conv_6.c
 * @brief       Autogenerated AOT DEPTHWISE_CONV_2D kernel
 * @details     This file was generated by HeliosAOT v0.2.2 on 2025-08-05.
 *   This kernel represents node #6 in the corresponding graph.
 *
 * @date        2025-08-05
 *
 * @copyright
 *   © 2025 Ambiq. All rights reserved.
 *
 *   This generated C module is licensed for use **only** on Ambiq hardware
 *   incorporating Ambiq’s sub-threshold power optimized technology.
 *   Any other use is strictly prohibited.
 *
 *   See “LICENSE.txt” at the root of this distribution for full terms.
 *
 * @note        Do not edit this file—any changes will be overwritten.
 ******************************************************************************/
#include <stdalign.h>
#include "ns_ambiqsuite_harness.h"
#include "arm_nnfunctions.h"
#include "arm_nnsupportfunctions.h"
#include "str_ww_ref_model_depthwise_conv_6.h"

#if defined(ARM_MATH_MVEI)
#define SCRATCH_BUFFER_SIZE 7440
#define WEIGHT_SUM_BUFFER_SIZE 512
#elif defined(ARM_MATH_DSP)
#define SCRATCH_BUFFER_SIZE 0
#define WEIGHT_SUM_BUFFER_SIZE 0
#else
#define SCRATCH_BUFFER_SIZE 0
#define WEIGHT_SUM_BUFFER_SIZE 0
#endif

// Input dimensions: input shape is [1, H_IN, W_IN, C_IN]
static const cmsis_nn_dims dw_6_input_dims = { .n = 1, .h = 1, .w = 15, .c = 128 };

// Filter dimensions: weights shape is [1, H_FILT, W_FILT, C_OUT].
static const cmsis_nn_dims dw_6_filter_dims = { .n = 1, .h = 1, .w = 15, .c = 128 };

// Bias dimensions: bias shape is [1, 1, 1, C_OUT].
static const cmsis_nn_dims dw_6_bias_dims = { .n = 1, .h = 1, .w = 1, .c = 128 };

// Output dimensions: output shape is [1, H_OUT, W_OUT, C_OUT].
static const cmsis_nn_dims dw_6_output_dims = { .n = 1, .h = 1, .w = 1, .c = 128 };

// Quantization parameters (per-channel quantization)
static const int32_t dw_6_multiplier[128] = {
    1857826754, 1971940647, 1283135074, 1773880229, 1636711166, 1888526385, 1410005933, 1424494767, 1097860292, 1198578315, 1160216859, 1148172219, 1105684349, 1286864883, 1429771020, 1594994245, 1483324198, 1167440356, 1871687641, 1085997697,
    1986608845, 1123937258, 1242566011, 1385533218, 1869571289, 1819322996, 1546189253, 2032376309, 1148576166, 1978214763, 2010699057, 1094590722, 1621724215, 1417258683, 1076703767, 1975292732, 1938205819, 1434339725, 1767323256, 1295063401,
    1540778040, 1113755366, 1401045440, 1991376726, 1714633565, 1554059578, 1647591748, 1075238089, 1551081488, 1126244861, 1123135307, 1190849942, 1477770566, 1265237629, 1748019922, 1127422554, 1660822356, 1318183371, 1644284999, 2007735069,
    1778706965, 1410451254, 1592856798, 1144331342, 1547857021, 2112272758, 1903992338, 2036998042, 1271432262, 1999665450, 1738261441, 1873335829, 2022208636, 1231243721, 1346722828, 1539713163, 1346052691, 1596004346, 1309692790, 1612702302,
    1503084740, 1944374345, 1119908392, 1237098739, 1081893659, 1859388116, 1978651110, 1594146492, 1579267463, 1086356657, 1279886248, 1362851110, 1779997708, 1107445936, 1905574678, 2035789464, 1728322780, 1204545101, 1466393266, 1149162158,
    1347818940, 1689666813, 1384882427, 1123744491, 1894136774, 1586219525, 1221471720, 1134642788, 1558698677, 1816665873, 1126386580, 1738418428, 2089836095, 1697911600, 1146191527, 1629421470, 1582601716, 1096811498, 1310832606, 2100469018,
    1290545277, 1212222544, 1901009003, 1270258065, 2062222009, 1656555271, 1583522893, 1753964098
};
static const int32_t dw_6_shift[128] = {
    -9, -9, -9, -9, -10, -10, -8, -9, -8, -9, -9, -9, -9, -10, -10, -9, -10, -9, -10, -9,
    -10, -8, -9, -10, -10, -9, -10, -10, -8, -10, -10, -9, -9, -9, -9, -10, -10, -9, -10, -9,
    -9, -9, -9, -10, -10, -9, -8, -9, -9, -9, -8, -8, -9, -10, -9, -9, -10, -9, -10, -10,
    -10, -8, -10, -8, -9, -10, -9, -10, -9, -10, -9, -10, -10, -9, -9, -10, -10, -9, -10, -9,
    -10, -9, -8, -9, -9, -9, -10, -10, -8, -8, -9, -9, -10, -8, -10, -9, -10, -8, -9, -9,
    -9, -10, -10, -9, -10, -11, -10, -9, -9, -10, -10, -10, -10, -10, -9, -9, -10, -9, -9, -11,
    -9, -9, -9, -9, -10, -10, -10, -10
};

// Offsets and activation parameters.
static const int32_t dw_6_input_zero_point = -128;
static const int32_t dw_6_output_zero_point = -5;


// Weight and bias data.
alignas(16) static NS_PUT_IN_TCM int8_t dw_6_weights[] = {
    4, -127, 72, -127, -63, -36, -44, -52, -127, -69, 72, 127, -105, -47, 87, 25, 83, 22, -32, -52,
    -29, 12, 69, 127, 83, -127, 127, 84, 127, 77, 76, 93, 127, 100, 13, 92, 45, -127, -41, 127,
    40, -127, 106, 85, -84, -24, -127, 29, -47, 82, -127, 127, 127, -87, -127, -83, 127, -24, -28, -90,
    -85, 63, -35, -127, 127, 88, 127, 127, 16, -127, 127, -46, -127, -101, 88, -127, -76, -19, 47, -127,
    -102, 30, 59, 78, -127, -4, 115, -46, 8, 127, -8, 74, -17, -127, 127, -45, -28, 127, 127, -104,
    -81, 92, 76, 48, -127, -42, -115, 127, -24, 65, 6, 30, -23, 60, 59, 127, 69, -60, 67, 71,
    122, 34, 127, -28, 1, 127, -40, -11, -11, -29, 86, -46, -13, -17, -10, -25, -54, -39, 82, 88,
    -49, -127, 79, 27, 6, 48, -31, -21, -52, 17, 20, 20, 71, -69, 69, 71, 65, 54, 77, 93,
    62, 77, 9, -19, -30, -91, 85, 107, 43, -59, 9, 6, -80, 6, -49, -8, -58, 68, -53, 70,
    71, -2, -124, -127, 48, -55, -16, -89, -86, 24, 4, -64, 24, 49, 42, 62, -12, -15, 79, -16,
    -45, -27, 42, 8, -93, -24, -16, -67, -64, 22, 27, 36, -95, -1, 7, -94, 1, 65, -18, 37,
    58, -67, 24, -41, -127, 55, 57, -1, -76, 64, -127, -51, -95, -89, 11, -19, -27, 70, 3, 75,
    0, 90, 75, 62, 18, 25, 32, -113, 60, -20, 49, -10, -4, 119, -124, -5, 18, -2, 55, -46,
    27, 109, -20, -18, -42, -24, 100, 42, -51, -67, 50, 37, 0, 39, -6, 59, -32, -8, 50, -44,
    73, -60, 80, 81, 59, 13, 112, 46, 65, 63, -28, 17, -127, -26, 127, 65, 12, -53, 11, 80,
    17, 2, -22, -2, -65, 67, -51, 27, 55, -127, -50, -66, 43, -84, -35, -127, -66, 17, 26, -33,
    -13, 37, 15, 16, -22, 4, 48, -81, 5, -1, 53, 10, -92, 11, 62, -44, -87, 14, 27, 64,
    -101, -19, 51, -1, -8, 16, -10, 32, -16, -61, 14, -25, -75, 57, 56, 41, -61, 64, -40, -32,
    -55, 19, -48, 16, -22, 98, -48, 27, -23, 127, 71, 70, -9, 8, 32, -119, 87, 19, 74, 6,
    38, 97, -8, 7, 7, 3, 97, -19, 36, 45, -35, 60, -41, -67, 127, 42, -53, 85, 14, 43,
    26, -23, -58, 9, -11, 10, 35, -27, 47, -34, 49, 86, 60, 47, 47, 34, 50, 80, 16, -6,
    -35, -59, 51, 34, 19, -25, 20, 75, -6, -27, -16, 1, -61, 25, -16, 14, 38, -71, -28, -19,
    89, -62, -3, -107, -9, 17, 11, -11, -16, 31, 24, 82, -43, 5, 31, -46, 55, -48, 39, 6,
    -127, 5, 6, -41, -72, 6, 22, 90, -87, -22, -1, -73, 1, 37, -60, 46, 17, -45, 55, -37,
    -87, 56, 27, -20, -40, 63, -110, 23, -91, 105, -58, 27, -4, 74, -76, 27, -11, -34, 35, 77,
    -81, 34, 34, 31, 103, 13, 47, -19, 15, 89, -7, -62, 4, -24, 55, -10, 113, -29, -31, 10,
    -11, -53, 95, 5, -63, 16, 54, 30, 56, 27, -41, 10, 12, -8, 0, 1, 42, -26, 80, 93,
    20, 48, -1, 73, 29, 83, 77, -40, -86, -36, 68, 6, 51, 7, 28, -7, -53, -41, -26, -43,
    -51, 56, -32, 27, 57, -17, -10, -2, 82, -50, 80, -114, 10, 18, -51, -27, 4, 101, 3, 57,
    -90, -74, 47, -37, -3, -69, -14, 36, 28, 19, -127, -65, -14, 5, 30, 96, -58, -24, -10, -127,
    3, 46, -53, 59, -10, -52, 90, -57, 28, 52, 28, 25, -52, 108, -89, 2, -102, -13, -111, 0,
    24, 119, 52, -26, 53, 28, 65, 56, -127, 60, 47, -45, 56, -15, 27, -39, 10, 82, 51, -48,
    4, -27, 71, -35, 59, -2, -34, -24, -31, -15, 88, -70, -127, 41, 13, 21, 6, 16, -29, 17,
    -55, -2, -3, -76, 107, -43, 96, 127, 38, 44, -50, 55, 49, 74, 127, -25, -25, 5, -49, -17,
    22, -4, -11, -7, 83, 25, -22, -50, -66, 105, -16, 43, 48, 1, -27, -66, 27, -63, 32, -38,
    -6, 20, -104, -32, -5, 127, 9, 0, -48, -66, 54, 28, -26, -57, 24, 85, 18, 3, -46, -33,
    35, 26, 37, 104, -20, -40, 51, 32, 2, 30, -10, 124, 28, -54, 41, -39, -49, 37, 7, 13,
    -37, 127, -120, -27, -87, -121, -125, 57, 18, 96, 28, -80, -7, 11, 16, 47, -27, 63, 41, -14,
    80, 55, 44, -38, 127, 96, 15, 84, 4, -32, 77, -44, -22, -77, -31, -77, -34, -11, 94, -74,
    -77, -23, 74, 52, -39, -17, -41, 75, -46, 10, -33, -59, 61, -50, 81, 93, 26, 73, -46, 64,
    27, 80, 92, -12, 5, -15, 1, 33, 29, 21, 9, -30, 14, 15, -22, -19, -14, 77, -21, 48,
    40, 69, -36, -40, -18, -48, -86, -93, 32, 25, -68, -33, 6, 94, 11, -11, -127, -25, 62, 49,
    -44, -44, -64, 43, 26, 13, -21, -21, 44, 36, 46, 127, -1, 3, 59, 51, 7, 1, -39, 88,
    52, -39, 45, -10, -13, 24, -24, 53, -60, 116, -95, -52, -10, 7, -110, -7, -32, 76, -4, 20,
    89, -9, 127, 27, -74, 28, 35, 14, 43, 34, 57, -29, 126, 1, 8, 51, -10, 3, 91, -6,
    -8, -66, -35, -16, -3, -12, -25, -35, -95, -59, 54, 50, -40, -38, 47, 21, -18, -3, 17, -60,
    61, -23, 71, 39, 21, 82, -53, 32, 63, 79, 31, -56, -1, 21, 34, 26, 51, -5, 25, -7,
    38, -41, -9, -20, -32, 30, -19, 8, 66, -26, -37, 43, -71, -64, -122, -40, -17, 19, -127, -31,
    -28, 39, 10, -60, -82, -4, 46, 49, -56, -28, -47, 107, 79, 52, 58, -33, 55, 19, 45, 119,
    -17, -12, 19, -39, 17, -11, -71, 80, -12, -40, -10, -32, -33, 34, 27, 48, -60, 1, -79, -42,
    -103, -74, 12, 2, -12, 127, -88, -23, -53, 23, 49, 40, -19, 85, 62, 46, 92, 3, 64, -20,
    48, 15, -22, 127, -32, 0, 127, -9, 30, 9, -33, 21, -33, 38, 19, -66, -44, -93, 23, 50,
    -25, -127, 92, 34, -4, -9, -27, -55, 34, -41, 92, 43, 14, 62, -29, -10, 20, 96, 32, 28,
    -39, 6, 54, 28, 60, 9, 75, 13, -46, -50, -11, -29, -40, 71, -24, 16, 46, -18, -26, 7,
    73, -82, -120, -83, -32, 9, -24, -17, 0, 35, 21, -15, -111, 12, 33, 79, 31, -35, -5, 78,
    82, 56, -61, -56, -5, 35, 53, 92, -81, -17, -48, 26, 10, -4, -56, 38, -9, -48, 44, -52,
    29, 17, 21, 15, -52, -3, -45, -20, -81, -1, -32, -5, 27, 64, 34, 35, -127, 2, 17, 55,
    -73, 1, 59, 47, 73, 61, 53, -58, 69, 3, -11, 22, -19, -18, 78, -11, 46, 13, -35, -24,
    -41, 8, 31, -6, -57, -100, 43, 27, -48, -69, 127, -26, 39, 2, -57, -69, 54, -53, 70, 67,
    14, 68, -26, 24, 20, 93, 29, -66, 29, 12, 113, 17, 35, 50, 75, 7, 7, -49, -4, -34,
    -56, 103, -32, 37, 21, -20, -15, -2, -33, -105, -127, -75, -5, 7, 19, -25, -19, 13, 8, 24,
    -90, 22, 27, -39, -5, -70, -57, 97, -20, 63, -36, -58, -25, 0, 46, 89, -19, -24, 74, -26,
    0, 13, 34, 76, -31, -30, 36, -53, -52, 27, 4, 18, -68, -67, -5, -114, -93, 80, -127, 59,
    -1, 107, -127, 21, 22, 108, 24, 32, -82, 22, 52, -71, 87, 28, 34, -61, 87, -1, 78, 101,
    -15, -13, 56, -42, 74, -11, -51, 2, -27, 33, 7, -33, -41, 3, 79, 71, -20, -98, 116, 21,
    36, -6, -51, -83, 84, -27, 109, 33, 27, 127, -44, 20, 10, 100, 11, -62, -25, 43, -11, -61,
    12, 23, 60, -127, -70, -48, -12, -58, -42, 56, -21, 30, 4, -3, 4, 38, -32, -96, -42, -63,
    -127, 16, 6, -37, 5, -24, 6, -15, -114, 80, 1, -79, 56, -69, -61, 62, 52, 36, 18, -40,
    4, 34, 73, 94, -5, -13, -66, 23, 19, 16, 30, 44, 6, -23, 6, -52, 29, 33, 20, 67,
    -73, 22, -38, -127, -71, 127, -44, 42, -12, 75, -47, 34, 0, -16, 71, 37, -111, 81, 13, 6,
    106, 78, 46, -93, 82, -99, -39, 27, -39, 30, 68, -38, 54, -101, -49, 15, -14, 91, -34, -88,
    -48, -19, -60, 66, -28, -29, 64, 41, 18, 13, -55, -85, 127, -20, 37, -9, 12, 93, -68, 27,
    16, 92, 32, -127, 49, 14, -34, 10, 38, 79, 48, -41, -43, -58, -5, -95, -46, 113, -19, 10,
    40, 49, -7, 9, -13, -80, -68, -82, -108, 23, -40, -19, 37, -25, -12, -11, -91, 26, -2, -127,
    8, -33, -46, 118, -69, 52, -30, -16, -48, 48, 53, 103, 14, -19, -127, 68, 16, 31, -21, 54,
    -69, -20, 110, -53, -4, 25, -13, 52, -88, 22, 15, -119, -76, -1, -75, 6, 35, 44, -58, 3,
    8, 42, 51, 13, 25, 58, 60, 77, 82, 63, 20, -81, 102, -19, 49, 57, -46, 11, 76, -20,
    81, -80, -46, 15, -18, 84, 22, -59, -54, 83, -68, 66, -103, -57, 55, 127, 85, 3, -69, -3,
    -34, -37, 55, -30, 20, 42, -43, 127, 47, 88, 39, -115, -95, 24, 43, 41, 43, -18, 46, 26,
    -112, -56, -12, -127, -72, 69, -10, 19, 23, 36, 37, 91, 110, -120, -91, -23, -45, 24, 21, -18,
    -22, -22, 14, -44, -73, 67, -19, -36, 72, -40, -73, 117, -22, 22, -58, -33, -35, 56, 56, 66,
    -10, -47, -3, 27, 32, 12, -16, 42, -127, -23, 59, -42, -20, 39, -49, 65, -105, 17, 33, -85,
    3, 88, 110, -13, -6, 96, -38, -12, 8, -3, 23, 19, 115, 25, 76, 127, 35, 83, 46, -127,
    63, 2, -79, 78, -52, -8, 53, -29, 127, -91, -56, -4, -9, 78, 0, -26, -46, 99, 127, 69,
    -114, -45, -40, 31, 29, -44, -64, -7, -29, -66, 40, -18, 7, 50, -50, 98, 52, 60, 9, -26,
    -2, 6, 37, -30, 74, 96, 67, -27, -70, -76, 3, -121, -99, 114, 3, 17, 52, 101, 33, 77,
    5, -93, -37, -25, 41, 76, 97, -14, -30, -28, -10, -69, -59, 50, -9, -40, 41, -60, -31, 84,
    -42, 48, 105, 10, -23, 89, 84, 56, -22, -65, 48, -35, 54, 14, -37, 31, -84, -19, 78, -66,
    -55, 34, -22, 43, -97, -21, 63, -88, -65, -111, 97, 12, 57, 104, -88, 5, 12, -12, 5, 21,
    119, 60, 89, 58, 67, 108, 41, -98, 19, 54, -127, 70, -127, -6, 81, -70, 75, -127, -127, 127,
    -24, 127, -34, -80, -63, 68, 50, 127, -127, -38, 9, 7, 127, -127, -127, 107, -53, -68, 64, -9,
    16, 126, -127, 32, 80, 127, 52, 80, 25, 70, 25, -66, 127, 48, 127, -80, -127, -127, -15, -126,
    -127, 127, -39, 38, 48, 70, 42, 41, 121, -127, -12, -103, -85, 127, -45, -16, 15, -62, -6, -13,
    -97, 127, 52, -55, -4, -127, -127, -2, -67, 127, 36, -33, -127, 127, 127, 39, -100, -127, 9, -26,
    127, 9, -127, 127, -47, -30, 100, -127, -66, 57, -79, 127, -127, -8, 76, -89, -76, 4, 57, 57,
    127, 79, -55, 127, -25, -8, 33, 52, 67, 127, 127, 65, 127, 127, 83, -100, -50, 43, 40, 5
};

alignas(16) static NS_PUT_IN_TCM int32_t dw_6_bias[] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0
};

alignas(16) static NS_PUT_IN_TCM int8_t dw_6_scratch_buffer[SCRATCH_BUFFER_SIZE];
alignas(16) static NS_PUT_IN_TCM int8_t dw_6_weight_sum_buffer[WEIGHT_SUM_BUFFER_SIZE];

static cmsis_nn_context dw_6_ctx = {
    .buf = dw_6_scratch_buffer,
    .size = sizeof(dw_6_scratch_buffer),
};

static cmsis_nn_context dw_6_weight_sum_ctx = {
    .buf = dw_6_weight_sum_buffer,
    .size = sizeof(dw_6_weight_sum_buffer),
};


const cmsis_nn_per_channel_quant_params dw_6_quant_params = {
    .multiplier = (int32_t*)dw_6_multiplier,
    .shift = (int32_t*)dw_6_shift,
};

const cmsis_nn_dw_conv_params dw_6_dw_conv_params = {
    .input_offset = -dw_6_input_zero_point,
    .output_offset = dw_6_output_zero_point,
    .ch_mult = 1,
    .stride.w = 1,
    .stride.h = 1,
    .padding.w = 0,
    .padding.h = 0,
    .dilation.w = 1,
    .dilation.h = 1,
    .activation.min = -128,
    .activation.max = 127,
};

int32_t
str_ww_ref_model_depthwise_conv_6_init(void) {
    return arm_depthwise_convolve_weight_sum(
        (int32_t *)dw_6_weight_sum_buffer,
        NULL, // No scratch buffer required
        dw_6_weights,
        &dw_6_dw_conv_params,
        &dw_6_input_dims,
        &dw_6_filter_dims,
        &dw_6_output_dims,
        dw_6_dw_conv_params.input_offset,
        dw_6_bias
    );
}


int32_t
str_ww_ref_model_depthwise_conv_6_run(
    const int8_t* __restrict input,
    int8_t* __restrict output
) {

    return arm_depthwise_conv_wrapper_s8(
        &dw_6_ctx,
        &dw_6_weight_sum_ctx,
        &dw_6_dw_conv_params,
        &dw_6_quant_params,
        &dw_6_input_dims,
        input,
        &dw_6_filter_dims,
        dw_6_weights,
        &dw_6_bias_dims,
        dw_6_bias,
        &dw_6_output_dims,
        output
    );

}